# ✅ Unit Test Summary: RolesContract (角色合约单元测试总结)

该脚本专注于验证基于 OpenZeppelin `AccessControl` 的 `RolesContract` 的核心权限管理功能，包括角色授予、查询和撤销的权限控制。

## 一、部署与初始化 (Deployment & Initialization)

| 验证点 | 目标功能 | 关键结果 |
| :--- | :--- | :--- |
| **部署者权限** | 验证合约部署后，部署者是否自动获得最高管理员权限。 | ✅ 成功验证部署者拥有 `DEFAULT_ADMIN_ROLE`。 |
| **角色常量** | 验证合约中定义的核心业务角色哈希是否与本地计算值一致。 | ✅ 确认 `MANUFACTURER_ROLE`, `RETAILER_ROLE`, `SERVICECENTER_ROLE` 等角色的哈希定义正确。 |

## 二、角色授予权限 (Granting Roles)

这组测试验证了只有管理员才能授予新角色的权限。

| 测试场景 | 目标功能 | 验证结果 |
| :--- | :--- | :--- |
| **管理员授予 (成功)** | 管理员成功授予所有业务角色给对应的测试账户。 | ✅ 授予操作成功，未回退。 |
| **非管理员授予 (负面)** | 非管理员（`User`）尝试授予角色。 | ❌ 交易回退，提示 `AccessControlUnauthorizedAccount`，确保权限控制有效。 |

## 三、角色验证与查询 (Role Verification)

这组测试验证了合约提供的所有角色查询函数，确保角色状态的准确性。

| 测试场景 | 目标功能 | 验证结果 |
| :--- | :--- | :--- |
| **单一角色查询** | 验证 `isManufacturer()`, `isRetailer()`, `isServiceCenter()`。 | ✅ 拥有角色的地址返回 `true`，未拥有角色的地址返回 `false`。 |
| **综合角色查询** | 验证 `hasAnyRole()` 是否能正确检查任一业务角色。 | ✅ 拥有任一业务角色的地址返回 `true`，未拥有任何业务角色的地址返回 `false`。 |

## 四、角色撤销权限 (Revoking Roles)

这组测试验证了只有管理员才能撤销现有角色的权限。

| 测试场景 | 目标功能 | 验证结果 |
| :--- | :--- | :--- |
| **管理员撤销 (成功)** | 管理员成功撤销了 `Manufacturer` 角色。 | ✅ 撤销操作成功，且后续查询验证角色已移除。 |
| **非管理员撤销 (负面)** | 非管理员（`User`）尝试撤销角色。 | ❌ 交易回退，提示 `AccessControlUnauthorizedAccount`，并验证目标角色未被撤销，确保拒绝有效。 |